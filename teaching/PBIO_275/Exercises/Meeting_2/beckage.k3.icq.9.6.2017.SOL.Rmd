---
title: "R Notebook"
output:
  html_document: default
  html_notebook: default
---

 1. Read in the weight data that is posted on webpage as ‘Weight data’.

```{r}

wtData<-read.table("http://www.uvm.edu/~bbeckage/Teaching/DataAnalysis/Data/wts.txt",header=TRUE)

head(wtData)

```

 2. What type of object is the file read in as? If it is not a data frame, coerce it to one.
 
 
```{r}
class(wtData)

```


3. What are object/data types of each of the columns?

```{r}
str(wtData)

```



4. Plot weight (on y axis) vs height (on x axis) with different colored symbols for each gender.

```{r}

plot(wtData[wtData$gender=='f',]$height_in, wtData[wtData$gender=='f',]$weight_lbs,
     col="red",xlim=range(wtData$height_in),ylim=range(wtData$weight_lbs), ylab="Wt",xlab="Ht")
points(wtData[wtData$gender=='m',]$height_in,wtData[wtData$gender=='m',]$weight_lbs,col="blue",pch=2)

```


```{r}

library(lattice)
xyplot(height_in~weight_lbs|gender,data=wtData)
detach("package:lattice", unload=TRUE)

```



```{r}
library(ggplot2)
qplot(height_in, weight_lbs, data = wtData, colour = gender)
detach("package:ggplot2",unload=TRUE)

```

```{r}

library(ggplot2)
a<-ggplot(wtData, aes(x=height_in, y=weight_lbs))
a + geom_point(aes(color=factor(gender)))
  
detach("package:ggplot2",unload=TRUE)

```


5. Write a function to calculate ‘10!’, i.e., 10 factorial (10*9*8*...*1). Show the result for 10 and 20.

```{r}

myFactorial<-function(x){
  if(identical(x,0)) return(1)
  myProd<-1 
  for(i in x:1){ # this causes the index i to vary from 1 to 10
    myProd<-myProd*i
    # cat(paste("i= ",i,"; myProd= ",myProd,sep=""),fill=T) 
    # print(myProd)
    # browser()
  }
  return(myProd)
  # cat(paste("index= ",i,"; myProd= ",myProd,sep=""),fill=T) 
}

myFactorial(0)
myFactorial(1)
myFactorial(3)
myFactorial(4)

```

```{r}
myFactorial(3)
```


```{r}

myFactorial2<-function(x){
  if(identical(x,0)) return(1)
  return(tail(cumprod(1:x),1))
}

myFactorial2(0)
myFactorial2(1)
myFactorial2(3)
myFactorial2(4)

```


```{r}

myFactorial3<-function(x){
  if(identical(x,0)) return(1)
  return(x * myFactorial3(x-1))
}

myFactorial3(0)
myFactorial3(1)
myFactorial3(3)
myFactorial3(4)

```

Timing the functions:

```{r}
library(microbenchmark)

microbenchmark(myFactorial(10))

microbenchmark(myFactorial2(10))

microbenchmark(myFactorial3(10))

detach("package:microbenchmark",unload=TRUE)

```


This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file).
